---

title: Ultrasonic distance measurement using HC-SR04 ultrasonic module + Arduino Pro
date: '2013-08-20T14:40:00.000+05:30'

tags:
- SONAR
- Interfacing
- C#
- ultrasonic
- distance
- modules
- Arduino
- Sensor
- HC-SR04
modified_time: '2013-08-20T14:40:58.740+05:30'
thumbnail: http://1.bp.blogspot.com/-0OPH1p3A8R8/UhMxBbwHGOI/AAAAAAAAAzY/gmexyMDd7u8/s72-c/cct.jpg
blogger_id: tag:blogger.com,1999:blog-286864074933316179.post-6966659931745588102
blogger_orig_url: https://www.incrediblediy.com/2013/08/ultrasonic-distance-measurement-using.html
---

Ultrasonic sensors (Ping sensors) are widely used in distance measurement as they are cheap and has a quite good accuracy. I got this cheap HC-SR04 ultrasonic module from ebay and wanted to test it.<br />I found the datasheet for it from <a href="http://www.micropik.com/PDF/HCSR04.pdf">here</a>.<br /><br />According to the datasheet ;<br />Max Range = 400cm <br />Min Range = 2cm <br /><br />This algorithm should be used to get the echo from the module:<br />1. Give 10uS pulse to the TRIGGER pin.<br />2. Measure the pulse width at ECHO pin.<br />3. Calculate&nbsp; distance = (echo high level time√óvelocity of sound) / 2<br /><br />I connected the module to my Arduino Pro (Techduino) and wrote a small code for the testing. The code will send the calculated distance value to PC via its UART port.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-0OPH1p3A8R8/UhMxBbwHGOI/AAAAAAAAAzY/gmexyMDd7u8/s1600/cct.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="196" src="http://1.bp.blogspot.com/-0OPH1p3A8R8/UhMxBbwHGOI/AAAAAAAAAzY/gmexyMDd7u8/s400/cct.jpg" width="400" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-Oaury4YNYeA/UhMviv6Uu0I/AAAAAAAAAyw/-JjfyNf8CZ8/s1600/DSC_0080.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="227" src="http://1.bp.blogspot.com/-Oaury4YNYeA/UhMviv6Uu0I/AAAAAAAAAyw/-JjfyNf8CZ8/s400/DSC_0080.jpg" width="400" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />The code :<br /><br /><blockquote class="tr_bq">#define echo 8<br />#define trigger 9<br />long duration,distance;<br /><br />void setup() {<br />&nbsp;Serial.begin (9600);<br />&nbsp;pinMode(trigger, OUTPUT);<br />&nbsp;pinMode(echo, INPUT);<br />&nbsp;digitalWrite(trigger, LOW); <br />}<br /><br />void loop() {<br />&nbsp;digitalWrite(trigger, LOW); <br />&nbsp;digitalWrite(trigger, HIGH);<br />&nbsp;delayMicroseconds(10); <br />&nbsp;digitalWrite(trigger, LOW);<br />&nbsp;duration = pulseIn(echo, HIGH);<br />&nbsp;distance = duration/58;<br />&nbsp;if ((distance &gt;= 400) || (distance &lt;= 2))<br />&nbsp;distance = -1;<br />&nbsp;Serial.println(distance);<br />&nbsp;delay(60);<br />&nbsp; <br />}</blockquote>I checked the output from the Arduino to PC using a terminal program.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-RybtQ6XOJ_I/UhMvjYmBGrI/AAAAAAAAAy4/UbcwdpMtDlY/s1600/COm.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="315" src="http://1.bp.blogspot.com/-RybtQ6XOJ_I/UhMvjYmBGrI/AAAAAAAAAy4/UbcwdpMtDlY/s400/COm.jpg" width="400" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />After that I coded a small software to get the distance data and show it in a nice way using Visual C#. This is my first C# application and I referred <a href="http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.datareceived.aspx">here</a> and<a href="http://social.msdn.microsoft.com/Forums/vstudio/en-US/507f5d4b-d33e-40e0-8802-05fe46519658/crossthread-operation-not-valid"> here</a> for coding. You can download the source code and application from <a href="http://www.mediafire.com/download/81ge3i3b86gm832/SONAR.7z">here</a>.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-lD8H29HvElQ/UhMvj345EqI/AAAAAAAAAzA/hKwJkhPIwGI/s1600/sonar.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-lD8H29HvElQ/UhMvj345EqI/AAAAAAAAAzA/hKwJkhPIwGI/s1600/sonar.jpg" /></a></div><br /><br /><br />