---

title: Step counter for Unipolar stepper motor
date: '2013-02-17T10:01:00.001+05:30'

tags:
- 16F887
- LCD
- ULN2803
- Driver
- DIY
- Motor
- Darlington
- Counter
- Microcontroller
- development
- I/O
- PIC16F887
modified_time: '2013-02-17T10:01:16.563+05:30'
thumbnail: http://lh3.ggpht.com/-NSCdhjjO7OI/USBcyP1GXcI/AAAAAAAAAHc/jMa53f9sAbM/s72-c/DSCF5600_800x600_thumb%25255B1%25255D.jpg?imgmax=800
blogger_id: tag:blogger.com,1999:blog-286864074933316179.post-2540899949475262637
blogger_orig_url: https://www.incrediblediy.com/2013/02/step-counter-for-unipolar-stepper-motor.html
---

<p>In <a href="http://www.incrediblediy.com/2013/02/driving-unipolar-stepper-motor-using.html">previous post</a>.I told you that I was able to drive an old scavenged unipolar stepper motor from my old printer.As I couldn’t find any datasheet it was not possible to fine how many steps needed for a full turn.I plugged in my <a href="http://www.incrediblediy.com/2013/02/simple-162-lcd-driver-with-pic16f887.html">16*2 LCD</a> to the my board and coded a bit to get that measurement. </p>  <p>The circuit and configuration bits are exactly same as the <a href="http://www.incrediblediy.com/2013/02/driving-unipolar-stepper-motor-using.html">unipolar stepper driver post.</a> The only difference is&#160; plugged the LCD to the connector.</p>  <p>This is the completed circuit.</p>  <p><a href="http://lh4.ggpht.com/-ZtaYExy5KL4/USBcvcbGUZI/AAAAAAAAAHU/im3AosJR9vo/s1600-h/DSCF5600_800x600%25255B4%25255D.jpg"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="DSCF5600_800x600" border="0" alt="DSCF5600_800x600" src="http://lh3.ggpht.com/-NSCdhjjO7OI/USBcyP1GXcI/AAAAAAAAAHc/jMa53f9sAbM/DSCF5600_800x600_thumb%25255B1%25255D.jpg?imgmax=800" width="804" height="604" /></a></p>  <p>I marked a small point at the staring point the given time using a marker pen. Using it I can count how many turns it rotated.</p>  <p><a href="http://lh4.ggpht.com/-_DGrA5nzWps/USBc1c9m3OI/AAAAAAAAAHk/ay9qflz_6pQ/s1600-h/DSCF5603_800x600%25255B4%25255D.jpg"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="DSCF5603_800x600" border="0" alt="DSCF5603_800x600" src="http://lh4.ggpht.com/-FNDtE8kccxA/USBc3yncJ4I/AAAAAAAAAHs/a3y-WoAehfE/DSCF5603_800x600_thumb%25255B1%25255D.jpg?imgmax=800" width="804" height="604" /></a></p>  <p>Here is the code <img style="border-bottom-style: none; border-right-style: none; border-top-style: none; border-left-style: none" class="wlEmoticon wlEmoticon-winkingsmile" alt="Winking smile" src="http://lh5.ggpht.com/-d_65lYZg-E0/USBc4VKLIgI/AAAAAAAAAH0/xozLgUx23gk/wlEmoticon-winkingsmile%25255B2%25255D.png?imgmax=800" />The bolded lines are used to calculate and show the number of steps <img style="border-bottom-style: none; border-right-style: none; border-top-style: none; border-left-style: none" class="wlEmoticon wlEmoticon-openmouthedsmile" alt="Open-mouthed smile" src="http://lh5.ggpht.com/-lyEev0imVdM/USBc5Er8UcI/AAAAAAAAAH8/uR8fTj8lFVE/wlEmoticon-openmouthedsmile%25255B2%25255D.png?imgmax=800" /></p>  <table border="1" cellspacing="0" cellpadding="2" width="400"><tbody>     <tr>       <td valign="top" width="400">         <p>sbit LCD_RS at RB5_bit;           <br />sbit LCD_EN at RB4_bit;            <br />sbit LCD_D4 at RB3_bit;            <br />sbit LCD_D5 at RB2_bit;            <br />sbit LCD_D6 at RB1_bit;            <br />sbit LCD_D7 at RB0_bit;</p>          <p>sbit LCD_RS_Direction at TRISB5_bit;           <br />sbit LCD_EN_Direction at TRISB4_bit;            <br />sbit LCD_D4_Direction at TRISB3_bit;            <br />sbit LCD_D5_Direction at TRISB2_bit;            <br />sbit LCD_D6_Direction at TRISB1_bit;            <br />sbit LCD_D7_Direction at TRISB0_bit;</p>          <p>void main() {</p>          <p><strong> int count=0;             <br /> char CountStr[7];              <br /></strong>&#160;&#160;&#160; osccon = 0x70;            <br />&#160;&#160;&#160; ansel&#160; = 0;            <br />&#160;&#160;&#160; anselh&#160; = 0;            <br />&#160;&#160;&#160; trisa = 0;            <br />&#160;&#160;&#160; trisb = 0;            <br />&#160;&#160;&#160; trisc = 0;            <br />&#160;&#160;&#160; trisd = 0;            <br />&#160;&#160;&#160; Lcd_Init();</p>          <p>&#160; Lcd_Cmd(_LCD_CLEAR);           <br />&#160; Lcd_Cmd(_LCD_CURSOR_OFF);            <br />&#160; Lcd_Out(1,1,&quot;Step Count:&quot;);</p>          <p>&#160; for(;;){           <br />&#160; portd.f4=1;            <br />&#160; <br />&#160; porta.f7=1;            <br />&#160; porta.f6=0;            <br />&#160; portc.f0=0;            <br />&#160; portc.f1=0;</p>          <p>&#160; delay_ms(10);</p>          <p>&#160; porta.f7=0;           <br />&#160; porta.f6=1;            <br />&#160; portc.f0=0;            <br />&#160; portc.f1=0;            <br />&#160; <br />&#160; delay_ms(10);            <br />&#160; <br />&#160; porta.f7=0;            <br />&#160; porta.f6=0;            <br />&#160; portc.f0=1;            <br />&#160; portc.f1=0;</p>          <p>&#160; delay_ms(10);           <br />&#160; <br />&#160; porta.f7=0;            <br />&#160; porta.f6=0;            <br />&#160; portc.f0=0;            <br />&#160; portc.f1=1;</p>          <p>&#160; portd.f4=0;           <br />&#160; delay_ms(10);            <br />&#160; <br /><strong>&#160; count=count+1;             <br />&#160; IntToStrWithZeros(count, CountStr);              <br />&#160; Lcd_Out(2,1,CountStr);</strong>            <br />&#160; delay_ms(2000)&#160;&#160; ;            <br />&#160; }            <br />&#160;&#160;&#160; <br />}</p>       </td>     </tr>   </tbody></table>    <p><a href="http://lh3.ggpht.com/-F1NV-h6fU2I/USBc7-UDZPI/AAAAAAAAAIE/jIcdgqsWcjY/s1600-h/Capture%25255B3%25255D.jpg"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="Capture" border="0" alt="Capture" src="http://lh3.ggpht.com/--HF5PdNKYLQ/USBc_TpxgDI/AAAAAAAAAIM/p7BAev9JBTE/Capture_thumb%25255B1%25255D.jpg?imgmax=800" width="805" height="516" /></a></p>  <p>I found out that it takes 120 steps to rotate a 360 degree full turn. That is simply 3degrees for a step. Impressive isn’t it ? <img style="border-bottom-style: none; border-right-style: none; border-top-style: none; border-left-style: none" class="wlEmoticon wlEmoticon-winkingsmile" alt="Winking smile" src="http://lh5.ggpht.com/-d_65lYZg-E0/USBc4VKLIgI/AAAAAAAAAH0/xozLgUx23gk/wlEmoticon-winkingsmile%25255B2%25255D.png?imgmax=800" /></p>  <p><a href="http://lh5.ggpht.com/-tw2tPYnfr-o/USBdCn5St9I/AAAAAAAAAIU/8ASNNElTOic/s1600-h/DSCF5605_800x600%25255B4%25255D.jpg"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="DSCF5605_800x600" border="0" alt="DSCF5605_800x600" src="http://lh4.ggpht.com/-NJ0PI9GH6oA/USBdEnRJ9WI/AAAAAAAAAIc/_uBeh731UZk/DSCF5605_800x600_thumb%25255B1%25255D.jpg?imgmax=800" width="804" height="604" /></a></p>  