---

title: PS/2 Keyboard Interface for PIC uC (PIC16F887)
date: '2013-02-23T20:42:00.001+05:30'

tags:
- 16F887
- Interface
- LCD
- keyboard
- DIY
- PS/2
- Microcontroller
- development
- Input
- I/O
- PIC16F887
modified_time: '2013-02-23T20:42:19.153+05:30'
thumbnail: http://lh3.ggpht.com/-MVCfNMhvTBo/USjb4OaGeII/AAAAAAAAAI4/jjHa7Y2B81I/s72-c/pinout_thumb%25255B1%25255D.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-286864074933316179.post-9190081894700366330
blogger_orig_url: https://www.incrediblediy.com/2013/02/ps2-keyboard-interface-for-pic-uc.html
---

<p>We need to get various kinds of inputs for our microcontroller circuit. If we need to use key board to input data,we can either use simple buttons or 4x4 keypad…etc. In here I’m going to show you how to use a standard PS/2 computer keyboard for this purpose. It is so cheap and readily available.It is easy to replace a keyboard even for a laymen in an error.</p>  <p>Here I’m using a Mercury branded PS/2 keyboard I got 10 years back.I just cut the cable and got wires directly connected to the circuit.You may find a female PS/2 keyboard socket from ebay or from an old motherboard and use in your projects.</p>  <p>Here is the pinout of a PS/2 keyboard and how i connected to the uC. uC pins are showed in red and the colours of wires on my keyboard are shown in brackets.</p>  <p><a href="http://lh5.ggpht.com/-y6gYHkj8ygc/USjb3TaH7CI/AAAAAAAAAIw/k9c8MdFHJOs/s1600-h/pinout%25255B3%25255D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="pinout" border="0" alt="pinout" src="http://lh3.ggpht.com/-MVCfNMhvTBo/USjb4OaGeII/AAAAAAAAAI4/jjHa7Y2B81I/pinout_thumb%25255B1%25255D.png?imgmax=800" width="464" height="202" /></a></p>  <p>Here is the circuit I used to test this.It consists of a 16F887 uC and a simple 16*2 LCD display.You can find additional information on my <a href="http://www.incrediblediy.com/2013/02/simple-162-lcd-driver-with-pic16f887.html">previous post</a>.</p>  <p><a href="http://lh3.ggpht.com/-OmvY14Fs4Xg/USjb5ACi27I/AAAAAAAAAJA/X-WqsIk3WcA/s1600-h/DSCF5562_800x600%25255B4%25255D.jpg"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="DSCF5562_800x600" border="0" alt="DSCF5562_800x600" src="http://lh4.ggpht.com/-JHG6SwvI2sk/USjb7eOSB8I/AAAAAAAAAJI/qBC7tqKBamw/DSCF5562_800x600_thumb%25255B1%25255D.jpg?imgmax=800" width="604" height="804" /></a></p>  <p>Here is the connection between keyboard and the circuit <img style="border-bottom-style: none; border-right-style: none; border-top-style: none; border-left-style: none" class="wlEmoticon wlEmoticon-winkingsmile" alt="Winking smile" src="http://lh4.ggpht.com/-85zvWSncRPo/USjb8FZ_kFI/AAAAAAAAAJQ/_-1VJwFW0Yw/wlEmoticon-winkingsmile%25255B2%25255D.png?imgmax=800" /></p>  <p><a href="http://lh6.ggpht.com/-LMsQqkhqqo4/USjcBaTIKnI/AAAAAAAAAJY/hSsDYcaFz2Q/s1600-h/DSCF5619_1024x768%25255B9%25255D.jpg"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="DSCF5619_1024x768" border="0" alt="DSCF5619_1024x768" src="http://lh6.ggpht.com/-Y9wglsGByKM/USjcEj5rebI/AAAAAAAAAJg/pgHpr3tA_RA/DSCF5619_1024x768_thumb%25255B6%25255D.jpg?imgmax=800" width="644" height="484" /></a></p>  <p>I used MikroC built in PS/2 keyboard library for this purpose. You can find more information from <a href="http://www.mikroe.com/download/eng/documents/compilers/mikroc/pro/pic/help/ps2_library.htm">here</a>.</p>      <p>I wrote a simple program to display the ASCII value of the pressed key and to show pressed keys in the LCD. You can change the code as you like to get key presses as you wish. The PS/2 library help page is much useful in this.Please note the bolded lines are for keyboard stuff.</p>  <table border="1" cellspacing="0" cellpadding="2" width="400"><tbody>     <tr>       <td valign="top" width="400">         <p>sbit LCD_RS at RB5_bit;           <br />sbit LCD_EN at RB4_bit;            <br />sbit LCD_D4 at RB3_bit;            <br />sbit LCD_D5 at RB2_bit;            <br />sbit LCD_D6 at RB1_bit;            <br />sbit LCD_D7 at RB0_bit;</p>          <p>sbit LCD_RS_Direction at TRISB5_bit;           <br />sbit LCD_EN_Direction at TRISB4_bit;            <br />sbit LCD_D4_Direction at TRISB3_bit;            <br />sbit LCD_D5_Direction at TRISB2_bit;            <br />sbit LCD_D6_Direction at TRISB1_bit;            <br />sbit LCD_D7_Direction at TRISB0_bit;</p>          <p>           <br /><strong>sbit PS2_Data&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; at RA7_bit;             <br />sbit PS2_Clock&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; at RA6_bit;              <br />sbit PS2_Data_Direction&#160; at TRISA7_bit;              <br />sbit PS2_Clock_Direction at TRISA6_bit;              <br />unsigned short keydata = 0, special = 0, down = 0;</strong></p>          <p>void main() {           <br />&#160;&#160; <strong> char txt[7];             <br />&#160;&#160;&#160; short place=1;              <br /></strong>&#160;&#160;&#160; osccon = 0x70;            <br />&#160;&#160;&#160; ansel&#160; = 0;            <br />&#160;&#160;&#160; anselh&#160; = 0;            <br />&#160;&#160;&#160; trisa = 0;            <br />&#160;&#160;&#160; trisb = 0;            <br />&#160;&#160;&#160; trisc = 0;            <br />&#160;&#160;&#160; trisd = 0;            <br />&#160;&#160;&#160; Lcd_Init();            <br />&#160;&#160;&#160; <strong>Ps2_Config();</strong></p>          <p>&#160; Lcd_Cmd(_LCD_CLEAR);           <br />&#160; Lcd_Cmd(_LCD_CURSOR_OFF);            <br />&#160; Lcd_Out(1,1,&quot;ASCII:&quot;);</p>          <p>&#160; for(;;){           <br />&#160; portd.f4=1;            <br />&#160; delay_ms(10);            <br />&#160; portd.f4=0;            <br />&#160; delay_ms(10);            <br />&#160; <br />&#160;<strong>&#160; if (Ps2_Key_Read(&amp;keydata, &amp;special, &amp;down)) {             <br />&#160;&#160;&#160; IntToStrWithZeros (keydata,txt);              <br />&#160;&#160;&#160; Lcd_Out(1,7,txt);              <br />&#160;&#160;&#160; Lcd_Out(2,place,&amp;keydata);              <br />&#160;&#160;&#160; Lcd_Out(2,place+1,&quot; &quot;);              <br />&#160;&#160;&#160; if (place==16){              <br />&#160;&#160;&#160; place=1; }              <br />&#160;&#160;&#160; else{              <br />&#160;&#160;&#160; place=place+1;              <br />&#160;&#160;&#160; }</strong></p>          <p>&#160;&#160;&#160; <strong>}             <br />&#160; delay_ms(10)&#160;&#160; ;              <br />&#160; }              <br /></strong>&#160;&#160;&#160; <br />}</p>       </td>     </tr>   </tbody></table>  <p>I used following configuration options for this. Please note I’m using 8Mhz internal oscillator in my projects.</p>  <p><a href="http://lh3.ggpht.com/-4I6RtF8ZsBE/USjcILfCsQI/AAAAAAAAAJo/GNY_zTTKOVY/s1600-h/Capture%25255B3%25255D.jpg"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="Capture" border="0" alt="Capture" src="http://lh6.ggpht.com/-ig7wqyLsh4w/USjcLpjHKMI/AAAAAAAAAJw/Js1zWhSt7WQ/Capture_thumb%25255B1%25255D.jpg?imgmax=800" width="805" height="516" /></a></p>  <p>Happy keyboarding!!!! <img style="border-bottom-style: none; border-right-style: none; border-top-style: none; border-left-style: none" class="wlEmoticon wlEmoticon-winkingsmile" alt="Winking smile" src="http://lh4.ggpht.com/-85zvWSncRPo/USjb8FZ_kFI/AAAAAAAAAJQ/_-1VJwFW0Yw/wlEmoticon-winkingsmile%25255B2%25255D.png?imgmax=800" /></p>  <p><a href="http://lh4.ggpht.com/-12tN-AJwH-M/USjcQUZO5zI/AAAAAAAAAJ4/gXseeWdxzdk/s1600-h/DSCF5624_1024x768%25255B4%25255D.jpg"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="DSCF5624_1024x768" border="0" alt="DSCF5624_1024x768" src="http://lh3.ggpht.com/-YZJ689Fjg_U/USjcUFKqVYI/AAAAAAAAAKA/4-ovcuqXQqo/DSCF5624_1024x768_thumb%25255B1%25255D.jpg?imgmax=800" width="1028" height="772" /></a></p>  